<!--
  TopToolbar.xaml
  UserControl for the application's top toolbar.
  Contains model selection, thermoelement placement, measurement import, layer toggles, export, trial selection, and help.
-->

<UserControl x:Class="fcb_thermo_app.Views.TopToolbar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Height="50"
             Background="{StaticResource DarkGreyBrush}">
  <Grid Margin="12,0">
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*"/>
      <!-- Left-aligned controls: Model selection, placement, import, layers, export -->
      <ColumnDefinition Width="*"/>
      <!-- Right-aligned controls: Trial selection, create model, help -->
    </Grid.ColumnDefinitions>

    <StackPanel Orientation="Horizontal"
                Background="{StaticResource DarkGreyBrush}"
                VerticalAlignment="Center"
                HorizontalAlignment="Left"
                Grid.Column="0">
      <!-- Model Selection -->
      <TextBlock Text="Model:"
                 Foreground="{StaticResource WhiteBrush}"
                 VerticalAlignment="Center"
                 Margin="0,0,8,0"/>
      <ComboBox x:Name="ModelSelection"
                Width="220"
                Height="32"
                Margin="8"
                Style="{StaticResource RoundedComboBoxStyle}"
                ItemsSource="{Binding Models}"
                DisplayMemberPath="NameWithSerial"
                SelectionChanged="SelectedModel_Changed"
                IsEditable="True"
                IsTextSearchEnabled="True">
        <ComboBox.ToolTip>
          <ToolTip Style="{StaticResource RoundedTooltipStyle}">
            Select the model to work with. You can search by name or serial.
          </ToolTip>
        </ComboBox.ToolTip>
      </ComboBox>

      <!-- Place Thermoelements -->
      <Button Content="Place Thermoelements"
              Click="PlaceThermoelements_Click"
              Style="{StaticResource RoundedButtonStyle}">
        <Button.ToolTip>
          <ToolTip Style="{StaticResource RoundedTooltipStyle}">
            Place thermoelements on the selected model.
          </ToolTip>
        </Button.ToolTip>
      </Button>
      <!-- Import GBD -->
      <Button Content="Import GBD"
              Click="ImportGBD_Click"
              Style="{StaticResource RoundedButtonStyle}">
        <Button.ToolTip>
          <ToolTip Style="{StaticResource RoundedTooltipStyle}">
            Import a GBD file to add data to the current model.
          </ToolTip>
        </Button.ToolTip>
      </Button>
      <!-- Layers -->
      <Button Content="Layers"
              Click="Layers_Click"
              Style="{StaticResource RoundedButtonStyle}">
        <Button.ToolTip>
          <ToolTip Style="{StaticResource RoundedTooltipStyle}">
            Show or hide different layers and data visualizations by selecting or unselecting the options.
          </ToolTip>
        </Button.ToolTip>
        <Button.ContextMenu>
          <ContextMenu Style="{StaticResource RoundedContextMenuStyle}">
            <MenuItem Header="Show Pyrometer"
                      Style="{StaticResource CheckMenuItemStyle}"
                      IsCheckable="True"
                      IsChecked="True"
                      StaysOpenOnClick="True"
                      Click="TogglePyrometer_Click"/>
            <MenuItem Header="Show Pyrometer Positions"
                      Style="{StaticResource CheckMenuItemStyle}"
                      IsCheckable="True"
                      IsChecked="True"
                      StaysOpenOnClick="True"
                      Click="TogglePyrometerPositions_Click"/>
            <MenuItem Header="Show Thermoelement Heatmap"
                      Style="{StaticResource CheckMenuItemStyle}"
                      IsCheckable="True"
                      IsChecked="True"
                      StaysOpenOnClick="True"
                      Click="ToggleThermoelementHeatmap_Click"/>
            <MenuItem Header="Show Thermoelement Values"
                      Style="{StaticResource CheckMenuItemStyle}"
                      IsCheckable="True"
                      IsChecked="True"
                      StaysOpenOnClick="True"
                      Click="ToggleThermoelementValues_Click"/>
            <MenuItem Header="Show Performance Settings Grid"
                      Style="{StaticResource CheckMenuItemStyle}"
                      IsCheckable="True"
                      IsChecked="True"
                      StaysOpenOnClick="True"
                      Click="TogglePerformanceSettingsGrid_Click"/>
            <MenuItem Header="Show Performance Settings Heatmap"
                      Style="{StaticResource CheckMenuItemStyle}"
                      IsCheckable="True"
                      IsChecked="True"
                      StaysOpenOnClick="True"
                      Click="TogglePerformanceSettingsHeatmap_Click"/>
            <MenuItem Header="Show Performance Settings Values"
                      Style="{StaticResource CheckMenuItemStyle}"
                      IsCheckable="True"
                      IsChecked="True"
                      StaysOpenOnClick="True"
                      Click="TogglePerformanceSettingsValues_Click"/>
          </ContextMenu>
        </Button.ContextMenu>
      </Button>
      <!-- Export -->
      <Button Content="Export"
              Click="Export_Click"
              Style="{StaticResource RoundedButtonStyle}">
        <Button.ToolTip>
          <ToolTip Style="{StaticResource RoundedTooltipStyle}">
            Export the current model and trial data.
          </ToolTip>
        </Button.ToolTip>
      </Button>
    </StackPanel>

    <StackPanel Orientation="Horizontal"
                VerticalAlignment="Center"
                HorizontalAlignment="Right"
                Grid.Column="2">
      <!-- Trial Selection -->
      <TextBlock Text="Trial:"
                 Foreground="{StaticResource WhiteBrush}"
                 VerticalAlignment="Center"
                 Margin="0,0,8,0"/>
      <ComboBox x:Name="TrialSelection"
                Width="300"
                Height="32"
                Margin="8"
                Style="{StaticResource RoundedComboBoxStyle}"
                DisplayMemberPath="DisplayString"
                SelectionChanged="SelectedTrial_Changed"
                DropDownOpened="TrialSelection_DropDownOpened"
                IsEditable="True"
                IsTextSearchEnabled="True">
        <ComboBox.ToolTip>
          <ToolTip Style="{StaticResource RoundedTooltipStyle}">
            Select a trial to view or edit. You can search by model, serialnumber or time of the trial.
          </ToolTip>
        </ComboBox.ToolTip>
      </ComboBox>
      <!-- Create New Model -->
      <Button Content="Create New Model"
              Click="CreateNewModel_Click"
              Style="{StaticResource RoundedButtonStyle}">
        <Button.ToolTip>
          <ToolTip Style="{StaticResource RoundedTooltipStyle}">
            Create a new model for analysis.
          </ToolTip>
        </Button.ToolTip>
      </Button>
      <!-- Help -->
      <Button Width="46"
              Height="36"
              Margin="8,0,0,0"
              Style="{StaticResource RoundedButtonStyle}"
              Click="HelpButton_Click">
        <Button.ToolTip>
          <ToolTip Style="{StaticResource RoundedTooltipStyle}">
            "Show help and instructions"
          </ToolTip>
        </Button.ToolTip>
        <TextBlock Text="?"
                   FontSize="20"
                   FontWeight="Bold"
                   VerticalAlignment="Center"
                   HorizontalAlignment="Center"/>
      </Button>
    </StackPanel>
  </Grid>
</UserControl>
